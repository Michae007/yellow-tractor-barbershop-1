name: DEBUG ANDROID PROJECT

on:
  workflow_dispatch:

jobs:
  debug:
    runs-on: ubuntu-latest
    
    steps:
    - name: üì• Checkout code
      uses: actions/checkout@v4
      
    - name: üîß Setup Environment
      uses: android-actions/setup-android@v3
      
    - name: üìã Analyze Project Structure
      run: |
        echo "=== –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó ANDROID –ü–†–û–ï–ö–¢–ê ==="
        cd android-app
        
        echo "1. –í–°–ï –§–ê–ô–õ–´ –í android-app:"
        ls -la
        
        echo ""
        echo "2. –°–û–î–ï–†–ñ–ò–ú–û–ï –ö–û–†–ù–ï–í–û–ì–û build.gradle:"
        cat build.gradle || echo "‚ùå –ù–µ—Ç build.gradle"
        
        echo ""
        echo "3. –°–û–î–ï–†–ñ–ò–ú–û–ï app/build.gradle:"
        cat app/build.gradle || echo "‚ùå –ù–µ—Ç app/build.gradle"
        
        echo ""
        echo "4. –°–û–î–ï–†–ñ–ò–ú–û–ï settings.gradle:"
        cat settings.gradle || echo "‚ùå –ù–µ—Ç settings.gradle"
        
        echo ""
        echo "5. –ü–†–û–í–ï–†–ö–ê AndroidManifest.xml:"
        find . -name "AndroidManifest.xml" -type f | head -5
        cat AndroidManifest.xml || echo "‚ùå –ù–µ—Ç AndroidManifest.xml"
        
        echo ""
        echo "6. –ì–†–ê–î–õ –ó–ê–î–ê–ß–ò:"
        ./gradlew tasks --no-daemon | grep -i "assemble\|build\|android" | head -20 || echo "‚ùå –ù–µ—Ç Android –∑–∞–¥–∞—á"
        
    - name: üèóÔ∏è Build with Detailed Logging
      run: |
        cd android-app
        echo "=== –ó–ê–ü–£–°–ö –°–ë–û–†–ö–ò –° –ü–û–î–†–û–ë–ù–´–ú –õ–û–ì–û–ú ==="
        ./gradlew clean assembleDebug --info --stacktrace
        
    - name: üìÅ Check Build Results
      run: |
        echo "=== –ü–†–û–í–ï–†–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –°–ë–û–†–ö–ò ==="
        cd android-app
        
        echo "1. –í–°–ï APK –§–ê–ô–õ–´:"
        find . -name "*.apk" -type f | head -20 || echo "‚ùå APK –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
        
        echo ""
        echo "2. –°–¢–†–£–ö–¢–£–†–ê –ü–ê–ü–ö–ò BUILD:"
        find . -name "build" -type d | head -10
        find . -name "build" -type d -exec ls -la {} \; 2>/dev/null | head -50 || echo "‚ùå –ù–µ—Ç –ø–∞–ø–æ–∫ build"
        
        echo ""
        echo "3. –§–ê–ô–õ–´ –í APP/BUILD:"
        ls -la app/build/ || echo "‚ùå –ù–µ—Ç app/build"
        
    - name: ‚¨ÜÔ∏è Upload Project Analysis
      uses: actions/upload-artifact@v4
      with:
        name: project-analysis
        path: android-app/
        retention-days: 1
