name: SIMPLE APK BUILD

on:
  workflow_dispatch:

jobs:
  simple-build:
    runs-on: ubuntu-latest
    
    steps:
    - name: üì• Checkout code
      uses: actions/checkout@v4
      
    - name: üîç Show Project Structure
      run: |
        echo "=== –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê ==="
        ls -la
        echo "=== –°–û–î–ï–†–ñ–ò–ú–û–ï ANDROID-APP ==="
        ls -la android-app/ || echo "‚ùå –ü–∞–ø–∫–∞ android-app –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!"
        echo "=== GRADLE –§–ê–ô–õ–´ ==="
        find . -name "*.gradle" -type f 2>/dev/null || echo "‚ùå Gradle —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
        
    - name: ‚öôÔ∏è Setup Android Environment
      uses: android-actions/setup-android@v3
      
    - name: üõ†Ô∏è Build APK
      run: |
        echo "üöÄ –ù–∞—á–∏–Ω–∞–µ–º —Å–±–æ—Ä–∫—É APK..."
        if [ -d "android-app" ]; then
          cd android-app
          echo "üìÅ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ android-app:"
          ls -la
          
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ gradlew
          if [ -f "gradlew" ]; then
            echo "üîß –ù–∞–π–¥–µ–Ω gradlew - –∑–∞–ø—É—Å–∫–∞–µ–º —Å–±–æ—Ä–∫—É..."
            chmod +x gradlew
            ./gradlew assembleDebug
          else
            echo "üîß Gradlew –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–π gradle..."
            gradle assembleDebug
          fi
        else
          echo "‚ùå –ü–∞–ø–∫–∞ android-app –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!"
          echo "üìÇ –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–∞–ø–∫–∏:"
          ls -la
        fi
        
    - name: üì¶ Find and Upload APK
      if: success()
      run: |
        echo "üîç –ò—â–µ–º —Å–æ–±—Ä–∞–Ω–Ω—ã–µ APK —Ñ–∞–π–ª—ã..."
        find . -name "*.apk" -type f | head -10 || echo "APK —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
        
    - name: ‚¨ÜÔ∏è Upload APK Artifact
      uses: actions/upload-artifact@v4
      with:
        name: android-apk
        path: |
          **/build/outputs/apk/**/*.apk
          **/app/build/outputs/apk/**/*.apk
        retention-days: 7
