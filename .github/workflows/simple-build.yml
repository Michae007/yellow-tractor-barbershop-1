name: SIMPLE APK BUILD

on:
  workflow_dispatch:

jobs:
  simple-build:
    runs-on: ubuntu-latest
    
    steps:
    - name: üì• Checkout code
      uses: actions/checkout@v4
      
    - name: üîç Show EXACT structure
      run: |
        echo "=== WHAT'S REALLY IN THE PROJECT? ==="
        pwd
        ls -la
        echo "=== ANDROID-APP FOLDER ==="
        ls -la android-app/ || echo "‚ùå NO ANDROID-APP FOLDER!"
        echo "=== GRADLE FILES ANYWHERE ==="
        find . -name "*.gradle" -type f 2>/dev/null || echo "‚ùå NO GRADLE FILES!"
        echo "=== ANY APK FILES? ==="
        find . -name "*.apk" -type f 2>/dev/null || echo "‚ùå NO APK FILES!"
        
    - name: üõ†Ô∏è Try basic Android setup
      run: |
        # –£—Å—Ç–∞–Ω–æ–≤–∏–º Android SDK –≤—Ä—É—á–Ω—É—é
        yes | sdkmanager --licenses
        sdkmanager "platform-tools" "platforms;android-33" "build-tools;33.0.0"
        
    - name: üéØ ATTEMPT BUILD
      run: |
        echo "üöÄ –ü–æ–ø—ã—Ç–∫–∞ —Å–±–æ—Ä–∫–∏..."
        if [ -d "android-app" ]; then
          cd android-app
          ls -la
          # –ü—Ä–æ—Å—Ç–æ –ø–æ–ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ —á—Ç–æ-—Ç–æ –¥–ª—è —Å–±–æ—Ä–∫–∏
          find . -name "build.gradle" -exec dirname {} \; | head -1 | while read dir; do
            echo "üìÅ –ù–∞–π–¥–µ–Ω –ø—Ä–æ–µ–∫—Ç –≤: $dir"
            cd "$dir"
            ./gradlew assembleDebug || gradle assembleDebug || echo "‚ùå –°–±–æ—Ä–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å"
          done
        else
          echo "‚ùå –ü–∞–ø–∫–∞ android-app –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!"
        fi
