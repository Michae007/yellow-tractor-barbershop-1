name: FIND AND FIX APK

on:
  workflow_dispatch:

jobs:
  find-apk:
    runs-on: ubuntu-latest
    
    steps:
    - name: üì• Checkout code
      uses: actions/checkout@v4
      
    - name: ‚öôÔ∏è Setup Environment
      uses: android-actions/setup-android@v3
      
    - name: üîç Deep Search for APK
      run: |
        echo "=== –ü–û–ò–°–ö –í–°–ï–• APK –§–ê–ô–õ–û–í ==="
        find . -name "*.apk" -type f 2>/dev/null | head -20 || echo "APK —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
        
        echo "=== –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê –ü–û–°–õ–ï –°–ë–û–†–ö–ò ==="
        cd android-app
        echo "1. –í—Å–µ —Ñ–∞–π–ª—ã:"
        ls -la
        echo ""
        echo "2. –ü–∞–ø–∫–∞ app:"
        ls -la app/ || echo "–ù–µ—Ç app"
        echo ""
        echo "3. –ü–∞–ø–∫–∞ build:"
        find . -name "build" -type d | head -10
        echo ""
        echo "4. –°–æ–¥–µ—Ä–∂–∏–º–æ–µ build –ø–∞–ø–æ–∫:"
        find . -name "build" -type d -exec ls -la {} \; 2>/dev/null | head -30
        
    - name: üõ†Ô∏è Build with Detailed Output
      run: |
        cd android-app
        echo "=== –ó–ê–ü–£–°–ö –°–ë–û–†–ö–ò –° –î–ï–¢–ê–õ–¨–ù–´–ú –í–´–í–û–î–û–ú ==="
        ./gradlew clean assembleDebug --info --stacktrace
        
    - name: üìã List Build Results
      run: |
        echo "=== –†–ï–ó–£–õ–¨–¢–ê–¢–´ –°–ë–û–†–ö–ò ==="
        cd android-app
        find . -name "*.apk" -type f | head -20 || echo "‚ùå APK –Ω–µ —Å–æ–∑–¥–∞–Ω"
        
        echo "=== –í–°–ï –í–´–•–û–î–ù–´–ï –§–ê–ô–õ–´ ==="
        find . -name "outputs" -type d | head -10
        find . -name "outputs" -type d -exec ls -la {} \; 2>/dev/null | head -30
        
    - name: ‚¨ÜÔ∏è Upload ANY APK Found
      uses: actions/upload-artifact@v4
      with:
        name: potential-apk
        path: |
          **/*.apk
          android-app/**/*.apk
          **/build/outputs/**/*.apk
        if-no-files-found: warn
        retention-days: 1
